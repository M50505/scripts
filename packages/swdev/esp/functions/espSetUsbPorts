#!/usr/bin/env bash
# vim:tabstop=2:shiftwidth=2:nu:filetype=sh
#	
# Author:              Martin Cribbins
# Revision history:
#
# 2026-02-18 - Initial version.
#	
#_doc ${1} 20260218115717 " " && exit 0

#optInit
#optAdd sample string "test"  "A sample string option"
#optAdd input string ""  "The input file to use."
#optAdd output string ""  "The output file to use."
#optAdd mark boolean false "A sample boolean option"
#optParse $* 
#optParseSuccess || exit 1


#[[ -n ${input} ]] && exec 0<${input}
#[[ -n ${output} ]] && exec 1>${output}

espSetUsbPorts ()
{
	local port

	port=$(usbListSerial  | egrep -i 'USB|SERIAL|CDC|ACM|CP21|FT' | egrep -iv JTAG | head -1)

	if [[ ! -z ${port} ]]
	then
		export ESPTOOL_PORT="${port%:*}"

		msgInfo The ESPTOOL_PORT environment variable is now set to ${ESPTOOL_PORT}
	else
		msgWarning "No esp32 serial communications-over-USB port was found."
	fi

	port=$(usbListSerial  | egrep -i 'JTAG' | head -1)

	if [[ ! -z ${port} ]]
	then
		export ESPTOOL_JTAG_PORT="${port%:*}"

		msgInfo The ESPTOOL_JTAG_PORT environment variable is now set to ${ESPTOOL_JTAG_PORT}
	else
		msgWarning "No esp32 serial JTAG-over-USB port was found."
	fi

}
